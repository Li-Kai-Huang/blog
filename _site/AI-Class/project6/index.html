<!DOCTYPE html>
<html lang="zh-TW">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/blog/feed.xml" title="LI KAI 部落格" />
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>AI 盲人導航系統 | LI KAI 部落格</title>
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="AI 盲人導航系統" />
<meta name="author" content="Li Kai_Huang" />
<meta property="og:locale" content="zh_TW" />
<meta name="description" content="這篇文章會講解我邊緣運算的第六個專案 AI 盲人導航系統" />
<meta property="og:description" content="這篇文章會講解我邊緣運算的第六個專案 AI 盲人導航系統" />
<link rel="canonical" href="http://localhost:4000/blog/AI-Class/project6/" />
<meta property="og:url" content="http://localhost:4000/blog/AI-Class/project6/" />
<meta property="og:site_name" content="LI KAI 部落格" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-06-07T15:40:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="AI 盲人導航系統" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Li Kai_Huang"},"dateModified":"2025-06-07T15:40:00+08:00","datePublished":"2025-06-07T15:40:00+08:00","description":"這篇文章會講解我邊緣運算的第六個專案 AI 盲人導航系統","headline":"AI 盲人導航系統","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/AI-Class/project6/"},"url":"http://localhost:4000/blog/AI-Class/project6/"}</script>
<!-- End Jekyll SEO tag -->

  
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.6/build/pure-min.css" crossorigin="anonymous">
  <link rel="stylesheet" href="https://unpkg.com/purecss@2.0.6/build/grids-responsive-min.css">
  <link rel="stylesheet" href="/blog/assets/css/open-color.css">
  <link rel="stylesheet" href="/blog/assets/css/hydure.css">

  <script async src="https://use.fontawesome.com/releases/v5.12.0/js/all.js"></script>

  

</head>


  <body>
    <div id="layout" class="pure-g">
      
      
      <div class="sidebar pure-u-1 pure-u-md-1-4" style="background-image: url(https://cdn.jsdelivr.net/gh/zivong/jekyll-theme-hydure@v2.0.0/cover.jpg);">
        <div class="sidebar-shield">
          <header class="header">
  <a class="brand-title" href="/blog/">LI KAI 部落格</a>
  <p class="brand-tagline">寫下我的生活與技術分享</p>

  
    <nav class="nav pure-menu">
      <ul class="pure-menu-list">
      
        <li class="nav-item pure-menu-item">
          <a href="/blog/" class="pure-menu-link ">
            Home
          </a>
        </li>
      
        <li class="nav-item pure-menu-item">
          <a href="/blog/about/" class="pure-menu-link ">
            About
          </a>
        </li>
      
        <li class="nav-item pure-menu-item">
          <a href="/blog/tags/" class="pure-menu-link ">
            Tags
          </a>
        </li>
      
        <li class="nav-item pure-menu-item">
          <a href="/blog/categories/" class="pure-menu-link ">
            Categories
          </a>
        </li>
      
        <li class="nav-item pure-menu-item">
          <a href="https://github.com/Li-Kai-Huang" class="pure-menu-link ">
            GitHub
          </a>
        </li>
      
      </ul>
    </nav>
  

  
    <div class="social pure-menu pure-menu-horizontal">
      <ul class="social-list pure-menu-list">
        
          <li class="social-item pure-menu-item">
            <a class="pure-menu-link pure-button" href="mailto:moray.huang@gmail.com" target="_blank">
              <i class="fas fa-envelope" title="Email"></i>
            </a>
          </li>
        
          <li class="social-item pure-menu-item">
            <a class="pure-menu-link pure-button" href="https://www.facebook.com/moray.huang" target="_blank">
              <i class="fab fa-facebook" title="FaceBook"></i>
            </a>
          </li>
        
          <li class="social-item pure-menu-item">
            <a class="pure-menu-link pure-button" href="https://www.instagram.com/likai._.huang" target="_blank">
              <i class="fab fa-Instagram" title="Instagram"></i>
            </a>
          </li>
        
          <li class="social-item pure-menu-item">
            <a class="pure-menu-link pure-button" href="https://github.com/Li-Kai-Huang" target="_blank">
              <i class="fab fa-github" title="GitHub"></i>
            </a>
          </li>
        
      </ul>
    </div>
  
</header>

        </div>
      </div>
      <div class="content pure-u-1 pure-u-md-3-4">
        <div class="main">
          <article class="post">
  
    <div class="post-meta">
      <ul class="post-categories"><li>
            <span class="post-category">1131邊緣運算課</span></li></ul>
    </div>
  
  <h1 class="post-title">AI 盲人導航系統</h1>
  <div class="post-meta">
    <time datetime="2025-06-07T15:40:00+08:00" itemprop="datePublished">
      07 Jun 2025
    </time></div>
  
  <h1 id="ai-盲人導航系統">AI 盲人導航系統</h1>
<p>本報告旨在介紹一款專為視障人士設計的AI 盲人導航系統。該系統旨在提供即時的語音定位輔助，幫助視障者更獨立、安全地探索周遭環境。其核心功能是透過掃描特定地點的二維碼 (QR Code)，迅速獲取二維碼內嵌的文字資訊（即地點名稱）。隨後，系統會利用文字轉語音 (Text-to-Speech, TTS) 技術將這個地點名稱轉換為清晰的語音指令，並立即透過音訊輸出裝置播放出來。</p>

<ul>
  <li><a href="#ai-盲人導航系統">AI 盲人導航系統</a>
    <ul>
      <li><a href="#功能">功能</a></li>
      <li><a href="#genai程式碼設計流程">GenAI程式碼設計流程</a></li>
      <li><a href="#程式碼產生提示">程式碼產生提示</a></li>
      <li><a href="#程式碼">程式碼</a></li>
      <li><a href="#實作成果">實作成果</a>
        <ul>
          <li><a href="#照片">照片</a></li>
          <li><a href="#影片">影片</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="功能">功能</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>掃描二維碼說出位置

  1. 掃描二維碼取得文字（地點名稱）

  2. 文字轉語音，取得文字的 mp3

  3. SDCardPlayMP3 播放 mp3 並說出位置名稱
</code></pre></div></div>

<h2 id="genai程式碼設計流程">GenAI程式碼設計流程</h2>

<pre><code class="language-mermaid">graph TD
    A[開始] --&gt; B(系統啟動/待機);
    B --&gt; C[掃描二維碼];
    C --&gt; D{成功解碼二維碼?};
    D -- 是 --&gt; E[取得文字 地點名稱];
    D -- 否 --&gt; F[掃描失敗/錯誤處理];
    F --&gt; B;

    E --&gt; G[將文字傳送至 Google TTS];
    G --&gt; H{TTS 生成 mp3 語音檔};
    H -- 成功 --&gt; I[接收 mp3 語音檔];
    H -- 失敗 --&gt; J[TTS 錯誤處理/提示音];
    J --&gt; B;

    I --&gt; K[將 mp3 儲存到 SD 卡 - 暫存];
    K --&gt; L[從 SD 卡讀取 mp3 並播放];
    L --&gt; M[語音播報完成];
    M --&gt; B;
</code></pre>

<p><strong>流程圖說明：</strong></p>

<ul>
  <li><strong>開始 (Start)：</strong> 系統啟動流程。</li>
  <li><strong>系統啟動/待機 (System Startup/Standby)：</strong> 系統初始化並等待掃描觸發。</li>
  <li><strong>掃描二維碼 (Scan QR Code)：</strong> 攝影機捕捉二維碼影像。</li>
  <li><strong>成功解碼二維碼? (Successfully Decode QR Code?)：</strong> 判斷二維碼是否成功解析。</li>
  <li><strong>是 (Yes)：</strong> 如果成功解碼。</li>
  <li><strong>取得文字 地點名稱 (Get Text Location Name)：</strong> 從二維碼中提取出地點名稱文字。</li>
  <li><strong>否 (No)：</strong> 如果解碼失敗。</li>
  <li><strong>掃描失敗/錯誤處理 (Scan Failed/Error Handling)：</strong> 執行錯誤處理，可能會有提示音或回到待機。</li>
  <li><strong>將文字傳送至 Google TTS (Send Text to Google TTS)：</strong> 將地點名稱文字發送到 Google Text-to-Speech 服務。</li>
  <li><strong>TTS 生成 mp3 語音檔 (TTS Generates MP3 Audio File)：</strong> Google TTS 將文字轉換為 mp3 格式的語音。</li>
  <li><strong>成功 (Success)：</strong> 如果 TTS 成功生成語音。</li>
  <li><strong>接收 mp3 語音檔 (Receive MP3 Audio File)：</strong> 接收從 TTS 返回的 mp3 語音數據。</li>
  <li><strong>失敗 (Failure)：</strong> 如果 TTS 服務失敗或超時。</li>
  <li><strong>TTS 錯誤處理/提示音 (TTS Error Handling/Prompt Tone)：</strong> 執行錯誤處理，可能會有提示音。</li>
  <li><strong>將 mp3 儲存到 SD 卡 (暫存) (Save MP3 to SD Card (Temporary))：</strong> 將接收到的 mp3 語音檔暫時儲存到 SD 卡。</li>
  <li><strong>從 SD 卡讀取 mp3 並播放 (Read MP3 from SD Card and Play)：</strong> 從 SD 卡讀取該 mp3 檔案並透過音訊輸出裝置播放。</li>
  <li><strong>語音播報完成 (Voice Broadcast Complete)：</strong> 語音播放結束。</li>
  <li><strong>返回到系統啟動/待機 (Return to System Startup/Standby)：</strong> 系統回到初始狀態，等待下一次掃描。</li>
</ul>

<h2 id="程式碼產生提示">程式碼產生提示</h2>

<p><img src="photo/AI盲人導航系統/螢幕擷取畫面%202025-06-14%20014155.png" alt="img" /></p>
<pre><code class="language-我想請你幫我做一個滿足以下條件的程式">功能： 掃描二維碼說出位置
步驟1. 掃描二維碼取得文字（地點名稱）
步驟2. 文字轉語音，取得文字的 mp3
步驟3. SDCardPlayMP3 播放 mp3 並說出位置名稱
我將提供範例程式 如下:
</code></pre>

<h2 id="程式碼">程式碼</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#undef DEFAULT
</span>
<span class="cp">#include</span> <span class="cpf">"VideoStream.h"</span><span class="cp">
#include</span> <span class="cpf">"QRCodeScanner.h"</span><span class="cp">
#include</span> <span class="cpf">"WiFi.h"</span><span class="cp">
#include</span> <span class="cpf">&lt;WiFiUdp.h&gt;</span><span class="cp">
#include</span> <span class="cpf">"GenAI.h"</span><span class="cp">
#include</span> <span class="cpf">"AmebaFatFS.h"</span><span class="cp">
</span>
<span class="c1">// --- NTP 時間同步相關庫 ---</span>
<span class="cp">#include</span> <span class="cpf">"NTPClient.h"</span><span class="cp">
</span>
<span class="c1">// --- WiFi Configuration ---</span>
<span class="kt">char</span> <span class="n">ssid</span><span class="p">[]</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>    <span class="c1">// **請務必更換為您的家庭 Wi-Fi SSID！**</span>
<span class="kt">char</span> <span class="n">pass</span><span class="p">[]</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>    <span class="c1">// **請務必更換為您的家庭 Wi-Fi 密碼！**</span>

<span class="c1">// --- Camera &amp; QR Code Scanner Configuration ---</span>
<span class="cp">#define CHANNEL 0
</span><span class="n">VideoSetting</span> <span class="nf">config</span><span class="p">(</span><span class="n">CHANNEL</span><span class="p">);</span>
<span class="n">QRCodeScanner</span> <span class="n">Scanner</span><span class="p">;</span>

<span class="c1">// --- Text-to-Speech &amp; SD Card Playback Configuration ---</span>
<span class="n">AmebaFatFS</span> <span class="n">fs</span><span class="p">;</span>
<span class="n">GenAI</span> <span class="n">tts</span><span class="p">;</span>
<span class="n">String</span> <span class="n">mp3Filename</span> <span class="o">=</span> <span class="s">"qrcode_location.mp3"</span><span class="p">;</span> <span class="c1">// 儲存語音檔的名稱</span>

<span class="c1">// --- NTP 客戶端實例 ---</span>
<span class="n">WiFiUDP</span> <span class="n">ntpUDP</span><span class="p">;</span>
<span class="c1">// **更改 NTP 伺服器為 time.google.com，通常更穩定**</span>
<span class="n">NTPClient</span> <span class="nf">timeClient</span><span class="p">(</span><span class="n">ntpUDP</span><span class="p">,</span> <span class="s">"time.google.com"</span><span class="p">,</span> <span class="mi">8</span> <span class="o">*</span> <span class="mi">3600</span><span class="p">);</span> <span class="c1">// 8 * 3600 是 UTC+8 (台灣時區)</span>

<span class="c1">// --- 函數原型 ---</span>
<span class="kt">void</span> <span class="nf">initWiFi</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">initNTP</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">sdPlayMP3</span><span class="p">(</span><span class="n">String</span> <span class="n">filename</span><span class="p">);</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="mi">115200</span><span class="p">);</span>

    <span class="c1">// 1. 初始化 WiFi 連線</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"--- 啟動 WiFi 連線 ---"</span><span class="p">);</span>
    <span class="n">initWiFi</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">!=</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"WiFi 連線失敗，無法進行後續操作。請檢查 SSID/密碼或網路環境。"</span><span class="p">);</span>
        <span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">);</span> <span class="c1">// 停止程式運行</span>
    <span class="p">}</span>

    <span class="c1">// 2. 初始化 NTP 時間同步 (在 WiFi 連線成功後執行)</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">--- 嘗試 NTP 時間同步 ---"</span><span class="p">);</span>
    <span class="n">initNTP</span><span class="p">();</span>

    <span class="c1">// 3. 配置攝影機影像通道並初始化</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">--- 初始化攝影機 ---"</span><span class="p">);</span>
    <span class="n">Camera</span><span class="p">.</span><span class="n">configVideoChannel</span><span class="p">(</span><span class="n">CHANNEL</span><span class="p">,</span> <span class="n">config</span><span class="p">);</span>
    <span class="n">Camera</span><span class="p">.</span><span class="n">videoInit</span><span class="p">();</span>

    <span class="c1">// 4. 啟動二維碼掃描器</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">--- 啟動二維碼掃描器 ---"</span><span class="p">);</span>
    <span class="n">Scanner</span><span class="p">.</span><span class="n">StartScanning</span><span class="p">();</span>

    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">系統已啟動，等待掃描二維碼..."</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">loop</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span> <span class="c1">// 控制掃描結果的檢索頻率</span>

    <span class="n">Scanner</span><span class="p">.</span><span class="n">GetResultString</span><span class="p">();</span>
    <span class="n">Scanner</span><span class="p">.</span><span class="n">GetResultLength</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">Scanner</span><span class="p">.</span><span class="n">ResultString</span> <span class="o">!=</span> <span class="n">nullptr</span> <span class="o">&amp;&amp;</span> <span class="n">Scanner</span><span class="p">.</span><span class="n">ResultLength</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">String</span> <span class="n">locationName</span> <span class="o">=</span> <span class="n">String</span><span class="p">((</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">Scanner</span><span class="p">.</span><span class="n">ResultString</span><span class="p">);</span> <span class="c1">// 修正中文亂碼問題</span>

        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"掃描到二維碼內容: "</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">locationName</span><span class="p">);</span>

        <span class="c1">// 避免重複播放相同內容</span>
        <span class="k">static</span> <span class="n">String</span> <span class="n">lastScannedContent</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">locationName</span> <span class="o">!=</span> <span class="n">lastScannedContent</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">lastScannedContent</span> <span class="o">=</span> <span class="n">locationName</span><span class="p">;</span>

            <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"正在將文字轉換為語音: "</span><span class="p">);</span>
            <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">locationName</span><span class="p">);</span>
            <span class="c1">// 語音轉換，語言代碼為 "zh-TW" (繁體中文)</span>
            <span class="n">tts</span><span class="p">.</span><span class="n">googletts</span><span class="p">(</span><span class="n">mp3Filename</span><span class="p">,</span> <span class="n">locationName</span><span class="p">,</span> <span class="s">"zh-TW"</span><span class="p">);</span>

            <span class="c1">// 給予足夠時間讓 TTS 處理並將檔案寫入 SD 卡</span>
            <span class="c1">// 尤其在網路或 SD 卡速度較慢時，這個延遲很重要</span>
            <span class="n">delay</span><span class="p">(</span><span class="mo">000</span><span class="p">);</span> <span class="c1">// 從 500ms 增加到 2000ms</span>

            <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"正在播放語音: "</span><span class="p">);</span>
            <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">mp3Filename</span><span class="p">);</span>
            <span class="n">sdPlayMP3</span><span class="p">(</span><span class="n">mp3Filename</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"內容相同，跳過語音播放。"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="c1">// --- WiFi 初始化函數實現 ---</span>
<span class="kt">void</span> <span class="nf">initWiFi</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 增加嘗試次數</span>
        <span class="n">WiFi</span><span class="p">.</span><span class="n">begin</span><span class="p">(</span><span class="n">ssid</span><span class="p">,</span> <span class="n">pass</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"正在連接到 "</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">ssid</span><span class="p">);</span>

        <span class="kt">uint32_t</span> <span class="n">StartTime</span> <span class="o">=</span> <span class="n">millis</span><span class="p">();</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">!=</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">millis</span><span class="p">()</span> <span class="o">-</span> <span class="n">StartTime</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// 等待最多 10 秒</span>
                <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"WiFi 連線超時，嘗試下一次..."</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">status</span><span class="p">()</span> <span class="o">==</span> <span class="n">WL_CONNECTED</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">WiFi 連線成功！"</span><span class="p">);</span>
            <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"STA IP 位址: "</span><span class="p">);</span>
            <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">WiFi</span><span class="p">.</span><span class="n">localIP</span><span class="p">());</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">WiFi 連線失敗。請檢查 SSID 和密碼，或更換網路環境。"</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// --- NTP 時間同步函數實現 ---</span>
<span class="kt">void</span> <span class="nf">initNTP</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"初始化 NTP 時間同步..."</span><span class="p">);</span>
    <span class="n">timeClient</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
    <span class="c1">// 嘗試更新時間，最多等待 15 秒 (增加等待時間)</span>
    <span class="kt">long</span> <span class="n">timeout</span> <span class="o">=</span> <span class="n">millis</span><span class="p">();</span>
    <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">timeClient</span><span class="p">.</span><span class="n">update</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">millis</span><span class="p">()</span> <span class="o">-</span> <span class="n">timeout</span> <span class="o">&lt;</span> <span class="mi">15000</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">timeClient</span><span class="p">.</span><span class="n">forceUpdate</span><span class="p">();</span> <span class="c1">// 強制更新</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"."</span><span class="p">);</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span> <span class="c1">// 每次嘗試間隔 1 秒</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">timeClient</span><span class="p">.</span><span class="n">update</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">時間同步成功！當前時間: "</span> <span class="o">+</span> <span class="n">timeClient</span><span class="p">.</span><span class="n">getFormattedTime</span><span class="p">());</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">時間同步失敗！"</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"這 **非常可能** 影響到 SSL 加密連線到 Google 翻譯。"</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"請檢查：1. 您的網路是否阻擋 NTP (UDP 123 埠)？ 2. 您的板子韌體/庫是否最新？"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// --- SD 卡播放 MP3 函數實現 ---</span>
<span class="kt">void</span> <span class="nf">sdPlayMP3</span><span class="p">(</span><span class="n">String</span> <span class="n">filename</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">fs</span><span class="p">.</span><span class="n">begin</span><span class="p">();</span>
    <span class="n">String</span> <span class="n">filepath</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="n">fs</span><span class="p">.</span><span class="n">getRootPath</span><span class="p">())</span> <span class="o">+</span> <span class="n">filename</span><span class="p">;</span>
    <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="n">fs</span><span class="p">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">MP3</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">file</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"--- 無法打開 MP3 檔案: "</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="n">filepath</span><span class="p">);</span>
        <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"可能是檔案不存在，或檔案已損壞，或 SD 卡有問題。"</span><span class="p">);</span>
        <span class="n">fs</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">Serial</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="s">"--- 正在設定音量並播放 MP3... "</span><span class="p">);</span>
    <span class="n">file</span><span class="p">.</span><span class="n">setMp3DigitalVol</span><span class="p">(</span><span class="mi">220</span><span class="p">);</span> <span class="c1">// 將音量提高到 220 (最大 255)</span>
    <span class="n">file</span><span class="p">.</span><span class="n">playMp3</span><span class="p">();</span>
    <span class="n">Serial</span><span class="p">.</span><span class="n">println</span><span class="p">(</span><span class="s">"播放完畢或中斷。"</span><span class="p">);</span>
    <span class="n">file</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
    <span class="n">fs</span><span class="p">.</span><span class="n">end</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="實作成果">實作成果</h2>

<h3 id="照片">照片</h3>

<ol>
  <li>qrcode偵測 Damo</li>
</ol>

<p><img src="/assets/photo/Edge-Ai-Class-Project/AI盲人導航系統/螢幕擷取畫面%202025-06-12%20122548.png" alt="imag" /></p>

<p><img src="/assets/photo/Edge-Ai-Class-Project/AI盲人導航系統/螢幕擷取畫面%202025-06-12%20142153.png" alt="imag" /></p>

<h3 id="影片">影片</h3>

<p>Damo影片<br />
<a href="https://www.youtube.com/watch?v=muGBQxwAWqU"><img src="https://img.youtube.com/vi/muGBQxwAWqU/0.jpg" alt="IMAGE ALT TEXT HERE" /></a><br />
點擊圖片播放</p>


  
    <div class="post-meta">
      <i class="post-tags-icon fas fa-tag"></i>
      <ul class="post-tags"><li>
            <span class="post-tag">入門</span></li><li>
            <span class="post-tag">學習</span></li><li>
            <span class="post-tag">blog</span></li></ul>
    </div>
  

  
</article>

        </div>
        <footer class="footer pure-g">
  <div class="pure-u-1 pure-u-md-1-2">
    <small>
      &copy;&nbsp;<time datetime="2025-06-14T23:16:14+08:00">2025</time>&nbsp;<a href="" target="_blank">Li Kai_Huang</a>. All right reserved.
    </small>
  </div>

  <div class="pure-u-1 pure-u-md-1-2">
    <small>
      Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a> & <a href="https://github.com/zivong/jekyll-theme-hydure" target="_blank">Hydure</a>
    </small>
  </div>
</footer>

      </div>
    </div>

    

    
  </body>
</html>
